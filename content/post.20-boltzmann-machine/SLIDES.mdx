---
title: Boltzmann Machines
description: An in-browser simulation of Boltzmann Machines.
tags: simulation
status: published
date: 2025-05-02
---

import { ArrowDown } from 'lucide-react'
import { Trainer } from './lib/trainer';
import { Button } from '../../components/ui/button'
import NetworkGraph from './components/network-graph'
import StateGraphs from './components/state-graphs'
import EnergyLossGraphs from './components/energy-loss-graphs'
import EnergyGraph from './components/energy-graph'
import CircularGraph from './components/circular-graph'
import WeightsGraph from './components/weights-graphs'
import Controls from './components/controls'
import Document from './document.mdx'
import ContrastiveDivergenceDerivation from './contrastive-divergence-derivation.mdx'
import DataGraphs from './components/data-graphs'
import SimulatorOneStep from './components/simulator-one-step'
import Simulator from './components/simulator'
import paper_image from './images/paper.png'

<VeslxFrontMatter />

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <div>
    # Boltzmann Machines are one of the earliest generative AI models, introduced in the 1980s.

    Boltzmann Machines are used for unsupervised learning, which means they can learn 
    from data without being told what to look for. 

    They can be used for generating new data that is similar to the data they were trained on, also known as generative AI.
  </div>

  <img
    src={paper_image}
    alt="Boltzmann Machine"
    width={400}
    height={400}
  />
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <div>
    # Boltzmann Machine

      A Boltzmann Machine is a type of neural network that tries to learn patterns by mimicking
      how energy works in physics.

      Each neuron can be on or off, the machine is made up of many of these neurons connected to each other.

      Some neurons are <span className="inline-block w-4 h-4 rounded-full border-1 border-black align-middle"></span> visible (we can see them and even set their state), and some are <span className="inline-block w-4 h-4 rounded-full bg-zinc-400  align-middle"></span> hidden (we can't see them).

      The connections between neurons are called weights, and they can be <span className="inline-block w-4 h-4 bg-green-500 align-middle"></span> positive or <span className="inline-block w-4 h-4 bg-red-500 align-middle"></span> negative.
  </div>

  <div>
    <CircularGraph
      width={400}
      height={400}
      weightsScale={2}
      neuronRadius={20}
    />

    <div className="text-xs text-center text-zinc-400">Hover over the neurons to highlight their connections.</div>
  </div>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <div className="flex flex-col items-center max-w-[500px]">
    <div className="text-2xl font-bold">General Boltzmann Machine</div>
    <CircularGraph
      width={400}
      height={400}
      weightsScale={2}
      neuronRadius={20}
    />
    <div className="text-xs text-center text-zinc-400">Hover over the neurons to highlight their connections.</div>
    <div>
    A General Boltzmann Machine has connections between all neurons. This makes it powerful, but its training involves calculating an $O(2^n)$ term.
    </div>
  </div>
  <div className="flex flex-col items-center max-w-[500px]">
    <div className="text-2xl font-bold">Restricted Boltzmann Machine</div>
    <CircularGraph
      width={400}
      height={400}
      weightsScale={2}
      neuronRadius={20}
      layout="horizontal"
    />
    <div>
    A Restricted Boltzmann Machine is a special case where the visible and hidden neurons are not connected within the same layer. This makes it faster to train and understand.
    </div>
  </div>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <div className="max-w-[500px]">
    # A Boltzmann Machine is an energy based model. 

    The energy of a configuration of the visible and hidden units is defined as:

    $$
      E(v,h) = -\sum_{i=1}^{m} \sum_{j=1}^{n} w_{ij} v_i h_j - \sum_{i=1}^{m} b_i v_i - \sum_{j=1}^{n} c_j h_j
    $$

    where $v$ is the visible layer, $h$ is the hidden layer, $w$ is the weight matrix, and $b$ and $c$ are the biases for the visible 
    and hidden layers, respectively. 
    
    The visualisation on the right randomises the weights, biases and activation values of a Boltzmann machine and calculates its energy.
  </div>
  <div className="min-w-[400px] max-w-[400px]">
    <EnergyGraph
      width={400}
      height={400}
      weightsScale={2}
      neuronRadius={20}
    />
  </div>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <div className="max-w-[500px]">
    # Training and Generation

    During training it is given examples (e.g., images, text) and the machine adjusts its 
    weights to lower the energy of those samples.

    It effectively learns $P(v)$, the probability of visible units $v$, which 
    is proportional to $e^{-E(v)}$.

    After training, it can sample new data from the learned distribution using Gibbs sampling.

    These samples are new, never-before-seen, but statistically similar to the training data.
  </div>

  <div className="min-w-[400px] max-w-[500px]">
    <DataGraphs />
  </div>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <Trainer>
    <SimulatorOneStep />
  </Trainer>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[120%]">
  <Trainer>
    <Simulator />
  </Trainer>
</div>

---

<div className="flex flex-row gap-12 items-center relative left-1/2 -translate-x-1/2 w-[180%]">
  <ContrastiveDivergenceDerivation />
</div>
